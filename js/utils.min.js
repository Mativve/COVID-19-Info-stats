"use strict";let STATS=null,apperance={safe_eye:0,dark_theme:!1};const date_options={weekday:"long",year:"numeric",month:"long",day:"numeric",hour12:!1,hour:"2-digit",minute:"2-digit"},date_short_options={day:"2-digit",month:"2-digit",year:"numeric"},site_url="https://mtve.ct8.pl/c19/",countup_options={separator:" "};function randid(e){return(e||"_")+Math.random().toString(36).substr(2,9)}let notify_el=document.getElementById("notify");function notify(e,t,a){notify_el.className="notify",e&&(notify_el.className="notify "+e),t&&(notify_el.children[0].innerHTML=t),a?(notify_el.classList.add("show"),setTimeout((function(){notify_el.classList.remove("show")}),a)):(notify_el.classList.add("show"),setTimeout((function(){notify_el.classList.remove("show")}),3e3))}function return_flag_url(e,t,a){let r=`https://flagcdn.com/w160/${e=e.toLowerCase()}.png`;if(!a)return r;{let e=new Image;e.src=r,e.onload=function(){let a="";0==e.width?(e=null,a="img/empty.png"):a=r,"function"==typeof t&&t(a)}}}function lazy_flag_init(){let e=document.querySelectorAll("[data-lazy-flag]");e.length>0&&e.forEach((function(e){return_flag_url(e.dataset.lazyFlag,(function(t){e.setAttribute("src",t)}),!0)}))}function random_range(e,t){if(!e)return console.error("max_number is null"),!1;if(!t)return console.error("max_randomed is null"),!1;let a=[];for(;a.length<t;){let t=Math.floor(Math.random()*e);-1===a.indexOf(t)&&a.push(t)}return a}function update_data_counter(e,t){if(!e)return console.error("Error data-counter: 'id' is empty"),!1;if(!t&&0!=t)return console.error("Error data-counter: 'val' is empty"),!1;let a=document.querySelector(`[data-counter="${e}"]`);a&&a.setAttribute("data-number",t)}let counters=document.querySelectorAll("[data-number]"),countups=[];function update_countup(){0!=countups.length&&countups.length==document.querySelectorAll("[data-number]").length||(counters=document.querySelectorAll("[data-number]")),counters.forEach((function(e){let t=randid("no_"),a=parseInt(e.getAttribute("data-number"));e.setAttribute("id",t);let r=new countUp.CountUp(`${t}`,Math.floor(a/2),countup_options);r.to=a,countups.push(r)})),setTimeout((function(){countups.forEach((function(e,t){e.update(e.to)}))}),100)}function apply_data_to_table(e){let t="",a=[],r={id:"",stats:{},random:!1,small:!1,clear:!1};if(r=Object.assign(r,e),""==r.id||0==r.stats.length)return!1;r.random&&(a=random_range(r.stats.length,20)),r.clear&&document.querySelectorAll(`#${r.id} .table-row:not(.table-head)`).forEach((function(e){e.remove()})),r.stats.forEach((function(e,n){let{name:l,code:o,new_cases:i,cases:s,new_deaths:d,deaths:c,new_recovered:u,recovered:g}=e;if("dp"!=o.toLowerCase()){let e="";e+=r.random&&-1===a.indexOf(n)?" hide":"",e+=r.small?" small":"",t+=`<div class="table-row ${e}" data-sort-id="${n+1}" data-sort-name="${l}" data-sort-infected="${i}" data-sort-deaths="${d}" data-sort-recovered="${g}">`,t+='<div class="table-el city" data-table-name="City:">',t+=`<img src="" data-lazy-flag="${o.toLowerCase()}" alt="${l}" class="icon">`,t+=`<span><button class="btn-link" data-set-view="country" data-params='{"slug":"${o}"}'>${get_country(o)}</button></span>`,t+="</div>",t+=`<div class="table-el infected" data-table-name="Infected:">${s} <small>(+${i})</small></div>`,t+=`<div class="table-el deaths" data-table-name="Deaths:">${c} <small>(+${d})</small></div>`,t+=`<div class="table-el recovered" data-table-name="Recovered:">${g} <small>(+${u})</small></div>`,t+="</div>"}}));let n=document.getElementById(r.id);n?n.insertAdjacentHTML("beforeend",t):console.error("Table "+id+" not exist"),lazy_flag_init()}function json2array(e){let t=[];return Object.keys(e).forEach((function(a){t.push(e[a])})),t}function find_by_prop(e,t,a){let r=[];for(let n=0;n<e.length;n++)e[n][t]==a&&r.push(e[n]);return r}function get_max_prop(e,t){let a;for(let r=0;r<e.length;r++)parseInt(e[r][t])>parseInt(a[t])&&(a=e[r]);return a}function get_min_prop(e,t){let a;for(let r=0;r<e.length;r++)parseInt(e[r][t])<parseInt(a[t])&&parseInt(e[r][t])>1&&(a=e[r]);return a}function get_top_max_by_prop(e,t,a){let r=e.slice().sort(((e,a)=>a[t]-e[t]));return r=r.slice(0,a),r}function get_top_min_by_prop(e,t,a,r=!0){let n=e.slice().sort(((e,a)=>e[t]-a[t]));return r||(n=n.filter((e=>e[t]>0))),n=n.slice(0,a),n}function format_date(e){let t=(e=e.split("/"))[0]<10?"0"+e[0]:e[0];return`${e[1],e[1]}-${t}-${"20"+e[2]}`}let last_target,charts=[];function set_chart(e,t,a){let r=charts.find((t=>t.canvas.getAttribute("id")==e)),n=t.days||null;if(r){switch(e){case"country_chart":{let e=t.confirmed||null,a=t.deaths||null,l=t.recovered||null;r.data.labels=n,r.data.datasets[0].data=e,r.data.datasets[1].data=a,r.data.datasets[2].data=l;break}case"daily":{let e=t.daily_confirmed||null,a=t.daily_deaths||null,l=t.daily_recovered||null;r.data.labels=n,r.data.datasets[0].data=e,r.data.datasets[1].data=a,r.data.datasets[2].data=l;break}case"daily_percentage":{let e=t.confirmed.slice(Math.max(t.confirmed.length-20,1))||null,a=t.deaths.slice(Math.max(t.deaths.length-20,1))||null,l=t.recovered.slice(Math.max(t.recovered.length-20,1))||null;r.data.labels=n.slice(Math.max(n.length-20,1))||null,r.data.datasets[0].data=a,r.data.datasets[1].data=e,r.data.datasets[2].data=l;break}}r.update()}else{let l,o,i=document.getElementById(e).getContext("2d");switch(e){case"country_chart":{let e=t.confirmed||null,a=t.deaths||null,r=t.recovered||null;l=n,o=[{label:set_lang("infected"),borderColor:"#0b93fb",backgroundColor:"rgba(0,0,0,0)",data:e},{label:set_lang("deaths"),borderColor:"#e45253",backgroundColor:"rgba(0,0,0,0)",data:a},{label:set_lang("recovered"),borderColor:"#2f7b63",backgroundColor:"rgba(0,0,0,0)",data:r}];break}case"daily":{let e=t.daily_confirmed||null,a=t.daily_deaths||null,r=t.daily_recovered||null;l=n,o=[{label:set_lang("infected")+" "+set_lang("daily"),borderColor:"#0b93fb",backgroundColor:"#0b93fb",data:e},{label:set_lang("deaths")+" "+set_lang("daily"),borderColor:"#e45253",backgroundColor:"#e45253",data:a},{label:set_lang("recovered")+" "+set_lang("daily"),borderColor:"#2f7b63",backgroundColor:"#2f7b63",data:r}];break}case"daily_percentage":{let e=t.confirmed.slice(Math.max(t.confirmed.length-20,1))||null,a=t.deaths.slice(Math.max(t.deaths.length-20,1))||null,r=t.recovered.slice(Math.max(t.recovered.length-20,1))||null;l=n.slice(Math.max(n.length-20,1))||null,o=[{label:set_lang("infected")+" "+set_lang("daily")+" (%)",borderColor:"#e45253",backgroundColor:"#e45253",data:a},{label:set_lang("deaths")+" "+set_lang("daily")+" (%)",borderColor:"#0b93fb",backgroundColor:"#0b93fb",data:e},{label:set_lang("recovered")+" "+set_lang("daily")+" (%)",borderColor:"#2f7b63",backgroundColor:"#2f7b63",data:r}];break}}r=new Chart(i,{type:a.type?a.type:"LineWithLine",data:{labels:l,datasets:o},options:{responsive:!0,elements:{line:{tension:.4},point:{radius:0,hoverRadius:0}},legend:{display:"small"!=a.size&&o.length>1},tooltips:{mode:"small"!=a.size&&"label",axis:"x",intersect:!1,callbacks:{label:function(t,a){return"daily_percentage"==e?t.yLabel+"%":t.yLabel}}},scales:{xAxes:[{display:!1,stacked:!!a.stacked}],yAxes:[{display:"small"!=a.size,scaleLabel:{show:!0,labelString:"Value"},ticks:{min:0,suggestedMax:"daily_percentage"==e?100:1e3},stacked:!!a.stacked}]}}}),charts.push(r)}}function zoom_to_country(e){if(last_target==e)return!1;last_target=e;let t=document.querySelector("#map .map-inner svg");t.parentNode.style="transform: scale(1)",t.style="transform: translate(0px, 0px)",setTimeout((function(){let a=0,r=0,n=1;if(e){let l=e.getBoundingClientRect(),o=t.getBoundingClientRect();a=-1*(l.top+l.height/2-(o.top+o.height/2)),r=-1*(l.left+l.width/2-(o.left+o.width/2)),n=o.width/o.height>l.width/l.height?o.height/l.height:o.width/l.width,n>30&&(n=30)}t.style=`transform: translate(${r.toFixed(2)}px, ${a.toFixed(2)}px)`,t.parentNode.style=`transform: scale(${n.toFixed(2)});`}),1e3)}function get_params(){const e=window.location.href;new URL(e);let t="{",a=window.location.search.substr(1).split("&");return a.forEach((function(e,r){let n=e.split("=");t+=`"${n[0]}":"${n[1]}"`,r<a.length-1&&(t+=",")})),t+="}",JSON.parse(t)}function set_url(e){e||(e=e=window.location.origin),window.history.pushState({url:e},document.title,e)}Chart.defaults.LineWithLine=Chart.defaults.line,Chart.controllers.LineWithLine=Chart.controllers.line.extend({draw:function(e){if(Chart.controllers.line.prototype.draw.call(this,e),this.chart.tooltip._active&&this.chart.tooltip._active.length){let e=this.chart.tooltip._active[0],t=this.chart.ctx,a=e.tooltipPosition().x,r=this.chart.legend.bottom,n=this.chart.chartArea.bottom;t.save(),t.beginPath(),t.moveTo(a,r),t.lineTo(a,n),t.lineWidth=2,t.strokeStyle="#ddd",t.stroke(),t.restore()}}});let set_view_triggers=document.querySelectorAll("[data-set-view]"),views=document.querySelectorAll("[data-view]");function set_view(e){let t=get_params(),a=t.v?t.v:"main";switch(views.forEach((function(e){e.classList.add("hide")})),a){case"country":{let e=t.slug?t.slug:"";""==e?(set_url(""),set_view()):set_single_country_stats(e);break}case"be-safe":document.querySelector('[data-set-view="be-safe"]').classList.add("hide");break;case"widget":break;default:case"main":case"":a="main",zoom_to_country(null),document.querySelector('[data-set-view="be-safe"]').classList.remove("hide")}document.querySelectorAll(`[data-view="${a}"]`).forEach((function(e){e.classList.remove("hide")}))}function update_set_view_triggers(){set_view_triggers=document.querySelectorAll("[data-set-view]"),set_view_triggers.forEach((function(e){e.addEventListener("click",(function(e){let t=e.target.getAttribute("data-set-view")||e.target.getAttribute("href"),a=e.target.getAttribute("data-params")||!1,r="";if(a.length){a=JSON.parse(a),Object.keys(a).forEach((function(e){r+=`&${e}=${a[e]}`}))}return set_url(window.location.origin+window.location.pathname+"?v="+t+r),set_view(e),e.preventDefault(),!1}))}))}function paginate_array(e){let t,a={page:1,per_page:5,items:{}};if(a=Object.assign(a,e),a.items.length>0){let e=a.page*a.per_page-a.per_page,r=a.page*a.per_page-1,n=a.items.slice(e,r),l=Math.ceil(a.items.length/a.per_page);t={items:n,prev:e>0,next:r<a.items.length-1,counter:`${a.page}/${l}`}}else t=!1;return t}function update_widget_triggers(){document.querySelectorAll("[data-widget]").forEach((function(e){e.addEventListener("click",(function(e){e.target.setAttribute("disabled","disabled");let t="";e.target.getAttribute("id")?(t=randid("copy_"),e.target.setAttribute("id",rid)):t=e.target.getAttribute("id");let a=e.target.innerHTML,r=e.target.getAttribute("data-widget")||!1,n=e.target.getAttribute("data-widget-size")||!1,l="country"==r?get_params().slug:"",o=0,i=0,s=window.location.href.replace(window.location.search,"")+"widget/index.html";o="small"==n?320:640,"global"==r?(i="big"==n?255:310,s+="?type=global"):"country"==r&&(i="big"==n?270:350,s+=`?type=country&slug=${l}`);let d=`<iframe src="${s}" width="${o}" height="${i}" frameborder="0"></iframe>`;if(navigator.clipboard){setTimeout((function(){e.target.innerHTML=a,e.target.removeAttribute("disabled")}),2e3);try{navigator.clipboard.writeText(d),notify("success","Widget copy to clipboard!",2e3),e.target.innerHTML="Copied!"}catch(e){console.error("copy failed",e)}}else notify("error","Sorry, your web browser or device not support clipboard, try copy manually code below\n"+d,1e4)}))}))}let theme_switch=!!document.getElementById("theme_switch")&&document.getElementById("theme_switch");function save_apperance(){localStorage.setItem("apperance",JSON.stringify(apperance))}function load_apperance(){localStorage.getItem("apperance")||save_apperance(),apperance=JSON.parse(localStorage.getItem("apperance"))}function set_theme(){document.body.setAttribute("data-dark",apperance.dark_theme),theme_switch.querySelector("i").className=apperance.dark_theme?"fas fa-sun":"fas fa-moon"}load_apperance(),set_theme(),theme_switch&&theme_switch.addEventListener("click",(function(){apperance.dark_theme=!apperance.dark_theme,save_apperance(),set_theme()}));let regex=/<br \/>(.*?\n?)*<br \/>/gim;function clear_json(e){let t=e;try{t=JSON.parse(t)}catch(e){console.log(e)}return t}
//# sourceMappingURL=utils.min.js.map